<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Language" content="en-us" />
  <meta http-equiv="imagetoolbar" content="false" />
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="-1">
  <meta name="MSSmartTagsPreventParsing" content="true" />
  <title>Mailbox | ElasticInbox API</title>
  <link href="../../css/reset.css" rel="stylesheet" type="text/css" />
  <link href="../../css/960.css" rel="stylesheet" type="text/css" />
  <link href="../../css/uv_active4d.css" rel="stylesheet" type="text/css" />
  <link href="../../shared/css/documentation.css" media="screen" rel="stylesheet" type="text/css">
  <link href="../../shared/css/pygments.css" media="screen" rel="stylesheet" type="text/css">
  <script src="../../shared/js/jquery.js" type="text/javascript"></script>
  <script src="../../shared/js/documentation.js" type="text/javascript"></script>
</head>
<body class="api">

    <div id="header-wrapper">
      <div id="header">
        <div>
          <a class="logo" href="../../"><img src="/api/images/elasticinbox-logo.png" /></a>
          <ul class="nav">
            <li><a href="../">REST API v2</a></li>
            <li><a href="http://www.elasticinbox.com">ElasticInbox.com</a></li>
          </ul>
        </div>
      </div><!-- #header -->
    </div><!-- #header-wrapper -->

    <div id="wrapper">
      <div class="content">
    <h1 id="mailbox">Mailbox</h1>

<p>Each mailbox contains labels and messages.</p>

<h2 id="purge-mailbox-a-namepurgea">Purge mailbox <a name="purge"></a>
</h2>

<p>Purges all deleted messages in the account older than the given date.</p>

<pre><code>PUT /rest/v2/:domain/:user/mailbox/purge
</code></pre>

<h3 id="parameters">Parameters</h3>

<dl>
<dt>age</dt>
  <dd>
<em>Optional</em> <strong>date</strong> - Purge messages only older than the given age. If not specified, all messages in the queue will be purged. Date can be in any format in the current locale which is understood by the <code>java.text.DateFormat.parse(String)</code>, for instance <code>"2011/04/15"</code> or <code>"2011/05/01 14:30"</code>.</dd>
</dl><h3 id="response">Response</h3>

<pre class="headers no-response"><code>Status: 204 No Content</code></pre>

<h3 id="example-request">Example request</h3>

<pre class="terminal">
% curl -XPUT "http://host:8181/rest/v2/domain.tld/user/mailbox/purge?age=2011%2F04%2F16"
</pre>

<h2 id="restore-a-namerestorea">Restore <a name="restore"></a>
</h2>

<p>Restore deleted messages.</p>

<p><strong>Note:</strong> This method has not been implemented yet.</p>

<pre><code>PUT /rest/v2/:domain/:user/mailbox/restore
</code></pre>

<h3 id="parameters-1">Parameters</h3>

<dl>
<dt>age</dt>
  <dd>
<em>Optional</em> <strong>date</strong> - Purge messages only older than the given age. If not specified, all messages in the queue will be purged. Date can be in any format in the current locale which is understood by the <code>java.text.DateFormat.parse(String)</code>, for instance <code>"2011/04/15"</code> or <code>"2011/05/01 14:30"</code>.</dd>
</dl><h3 id="response-1">Response</h3>

<pre class="headers no-response"><code>Status: 204 No Content</code></pre>

<h2 id="scrub-counters-a-namescrubcountersa">Scrub counters <a name="scrub_counters"></a>
</h2>

<p>Mailbox size, number of total and new messages rely on counters implemented in the storage layer. With Cassandra (currently the only supported storage system) there are a number of scenarios when counters may start deviating from the real data.</p>

<p>Use this method to fix corrupted counters. It will read metadata for all messages in the mailbox, recalculate and update counters.</p>

<pre><code>POST /rest/v2/:domain/:user/mailbox/scrub/counters
</code></pre>

<h3 id="response-2">Response</h3>

<pre class="headers no-response"><code>Status: 204 No Content</code></pre>

<h3 id="example-request-1">Example request</h3>

<pre class="terminal">
% curl -XPOST "http://host:8181/rest/v2/domain.tld/user/mailbox/scrub/counters"
</pre>

<h2 id="scrub-indexes-a-namescrubindexesa">Scrub indexes <a name="scrub_indexes"></a>
</h2>

<p>In case when label indexes became corrupted, it is possible to rebuild them from message metadata. This command will also recalculate and update counters similar to <a name="scrub_counters">scrub counters</a> method. </p>

<pre><code>POST /rest/v2/:domain/:user/mailbox/scrub/indexes
</code></pre>

<h3 id="response-3">Response</h3>

<pre class="headers no-response"><code>Status: 204 No Content</code></pre>

<h3 id="example-request-2">Example request</h3>

<pre class="terminal">
% curl -XPOST "http://host:8181/rest/v2/domain.tld/user/mailbox/scrub/indexes"
</pre>
      </div>

    <div id="js-sidebar" class="sidebar-shell">
      <div class="js-toggle-list sidebar-module expandable">
        <ul>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn expanded">&nbsp;</a><a href="../">Summary</a></h3>
          </li>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn expanded">&nbsp;</a><a href="../account/">Accounts</a></h3>
            <ul class="js-guides">
              <li><a href="../account/#add">Add</a></li>
              <li><a href="../account/#get">Get info</a></li>
              <li><a href="../account/#delete">Delete</a></li>
            </ul>
          </li>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn expanded">&nbsp;</a><a href="../label/">Labels</a></h3>
            <ul class="js-guides">
              <li><a href="../label/#get">Get all labels</a></li>
              <li><a href="../label/#add">Add</a></li>
              <li><a href="../label/#rename">Rename</a></li>
              <li><a href="../label/#delete">Delete</a></li>
            </ul>
          </li>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn expanded">&nbsp;</a><a href="./">Mailbox</a></h3>
            <ul class="js-guides">
              <li><a href="#purge">Purge</a></li>
              <li><a href="#restore">Restore</a></li>
              <li><a href="#scrub_counters">Scrub Counters</a></li>
            </ul>
          </li>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn expanded">&nbsp;</a><a href="../message/">Messages</a></h3>
            <ul class="js-guides">
              <li><a href="../message/#list">List messages</a></li>
              <li><a href="../message/#get">Get parsed message</a></li>
              <li><a href="../message/#raw">Get raw message</a></li>
              <li><a href="../message/#uri">Get raw message URI</a></li>
              <li><a href="../message/#partid">Get message part by Part ID</a></li>
              <li><a href="../message/#contentid">Get message part by Content ID</a></li>
              <li><a href="../message/#store">Store message</a></li>
              <li><a href="../message/#update">Update message</a></li>
              <li><a href="../message/#modify">Modify labels and markers</a></li>
              <li><a href="../message/#delete">Delete message</a></li>
            </ul>
          </li>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn expanded">&nbsp;</a><a href="../batch/">Batch Operations</a></h3>
            <ul class="js-guides">
              <li><a href="../batch/#modify">Batch message modify</a></li>
              <li><a href="../batch/#delete">Batch message delete</a></li>
            </ul>
          </li>
        </ul>
      </div> <!-- /sidebar-module -->
      <div class="sidebar-module">
        <p>This website is a <a href="https://github.com/elasticinbox" target="_blank">public GitHub repo</a>.</p>
      </div>
    </div><!-- /sidebar-shell -->

    </div><!-- #wrapper -->

    <div id="footer" >
      <div class="upper_footer">
        <div class="footer_inner clearfix">

        <ul class="footer_nav">
          <h4>ElasticInbox</h4>
          <li><a href="http://www.elasticinbox.com/">Home</a></li>
          <li><a href="http://www.elasticinbox.com/blog/">Blog</a></li>
          <li><a href="http://www.elasticinbox.com/download/">Downloads</a></li>
          <li><a href="http://www.elasticinbox.com/docs/">Docs</a></li>
          <li><a href="http://www.elasticinbox.com/contacts/">Contacts</a></li>
        </ul>

        </div><!-- /.site -->
      </div><!-- /.upper_footer -->
    </div><!-- /#footer -->

<!-- google analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-27981474-2']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</body>
</html>